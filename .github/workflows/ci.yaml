name: CI
on:
  workflow_dispatch:
  push:

# Cancel in-progress runs in current workflow.
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  sdk-generate:
    name: Generate SDKs
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-go@v2
        with:
          go-version: "1.20"
      - run: echo 'GOPATH='"$(go env GOPATH)" >> $GITHUB_ENV
        shell: bash
      - run: |
          wget https://github.com/go-swagger/go-swagger/releases/latest/download/swagger_linux_amd64 -O "$GOPATH/bin/swagger"
          chmod +x "$GOPATH/bin/swagger"
          bash <(curl https://raw.githubusercontent.com/ory/meta/master/install.sh) -b $GOPATH/bin ory
        shell: bash
      - run: make sdk
